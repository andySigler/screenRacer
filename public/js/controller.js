////////////////////////////////////////////////
////////////////////////////////////////////////
////////////////////////////////////////////////

var socket = io.connect();

socket.on('id',function(data){
	socket.emit('id',{'id':'controller'})
});

////////////////////////////////////////////////
////////////////////////////////////////////////
////////////////////////////////////////////////

var pad = document.getElementById('trackpad');

pad.addEventListener('mousemove', function(evt) {
    var mousePos = relMousePos(pad, evt);
    if(isStarted){
	    socket.emit('controlData',{'x':mousePos.x,'y':mousePos.y});
	}
}, false);

function relMousePos(theDivv, evt) {
    var rect = theDivv.getBoundingClientRect();
    return {
        x: (evt.clientX - rect.left) / rect.width,
        y: (evt.clientY - rect.top) / rect.height
    };
}

////////////////////////////////////////////////
////////////////////////////////////////////////
////////////////////////////////////////////////

var isStarted = false;

function start(){
	isStarted = !isStarted;
	if(isStarted){
		socket.emit('start',{});
	}
	else{
		socket.emit('end',{});
	}
}

////////////////////////////////////////////////
////////////////////////////////////////////////
////////////////////////////////////////////////